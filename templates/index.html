<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Eligibility Predictor</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>Loan Eligibility Predictor</h1>
            <p>Fill in your details to check your loan eligibility</p>
        </header>

        {% if prediction %}
        <div class="result-card {{ 'approved' if prediction == 'Approved' else 'rejected' }}">
            {% if prediction == 'Approved' %}
                <span class="result-icon">&#10003;</span>
                <h2>Congratulations! Loan Approved</h2>
                <p>Based on the provided details, you are eligible for the loan.</p>
            {% else %}
                <span class="result-icon">&#10007;</span>
                <h2>Loan Not Approved</h2>
                <p>Based on the provided details, you are not eligible at this time.</p>
            {% endif %}
        </div>
        {% endif %}

        {% if error %}
        <div class="result-card rejected">
            <p>{{ error }}</p>
        </div>
        {% endif %}

        <form method="POST" action="/">
            <!-- Personal Information -->
            <div class="form-section">
                <h2>Personal Information</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="Gender">Gender</label>
                        <select name="Gender" id="Gender" required>
                            <option value="" disabled {{ '' if form_data.get('Gender') else 'selected' }}>Select</option>
                            <option value="Male" {{ 'selected' if form_data.get('Gender') == 'Male' }}>Male</option>
                            <option value="Female" {{ 'selected' if form_data.get('Gender') == 'Female' }}>Female</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Married">Married</label>
                        <select name="Married" id="Married" required>
                            <option value="" disabled {{ '' if form_data.get('Married') else 'selected' }}>Select</option>
                            <option value="Yes" {{ 'selected' if form_data.get('Married') == 'Yes' }}>Yes</option>
                            <option value="No" {{ 'selected' if form_data.get('Married') == 'No' }}>No</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Dependents">Dependents</label>
                        <select name="Dependents" id="Dependents" required>
                            <option value="" disabled {{ '' if form_data.get('Dependents') else 'selected' }}>Select</option>
                            <option value="0" {{ 'selected' if form_data.get('Dependents') == '0' }}>0</option>
                            <option value="1" {{ 'selected' if form_data.get('Dependents') == '1' }}>1</option>
                            <option value="2" {{ 'selected' if form_data.get('Dependents') == '2' }}>2</option>
                            <option value="3" {{ 'selected' if form_data.get('Dependents') == '3' }}>3+</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Employment & Education -->
            <div class="form-section">
                <h2>Employment &amp; Education</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="Education">Education</label>
                        <select name="Education" id="Education" required>
                            <option value="" disabled {{ '' if form_data.get('Education') else 'selected' }}>Select</option>
                            <option value="Graduate" {{ 'selected' if form_data.get('Education') == 'Graduate' }}>Graduate</option>
                            <option value="Not Graduate" {{ 'selected' if form_data.get('Education') == 'Not Graduate' }}>Not Graduate</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Self_Employed">Self Employed</label>
                        <select name="Self_Employed" id="Self_Employed" required>
                            <option value="" disabled {{ '' if form_data.get('Self_Employed') else 'selected' }}>Select</option>
                            <option value="Yes" {{ 'selected' if form_data.get('Self_Employed') == 'Yes' }}>Yes</option>
                            <option value="No" {{ 'selected' if form_data.get('Self_Employed') == 'No' }}>No</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Financial Details -->
            <div class="form-section">
                <h2>Financial Details</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="ApplicantIncome">Applicant Income</label>
                        <input type="number" name="ApplicantIncome" id="ApplicantIncome" min="0" placeholder="e.g. 5000" value="{{ form_data.get('ApplicantIncome', '') }}" required>
                    </div>
                    <div class="form-group">
                        <label for="CoapplicantIncome">Co-applicant Income</label>
                        <input type="number" name="CoapplicantIncome" id="CoapplicantIncome" min="0" step="any" placeholder="e.g. 0" value="{{ form_data.get('CoapplicantIncome', '') }}" required>
                    </div>
                    <div class="form-group">
                        <label for="LoanAmount">Loan Amount (in thousands)</label>
                        <input type="number" name="LoanAmount" id="LoanAmount" min="1" step="any" placeholder="e.g. 150" value="{{ form_data.get('LoanAmount', '') }}" required>
                    </div>
                    <div class="form-group">
                        <label for="Loan_Amount_Term">Loan Term (months)</label>
                        <select name="Loan_Amount_Term" id="Loan_Amount_Term" required>
                            <option value="" disabled {{ '' if form_data.get('Loan_Amount_Term') else 'selected' }}>Select</option>
                            {% for term in [360, 180, 480, 240, 120, 60, 36, 84, 12] %}
                            <option value="{{ term }}" {{ 'selected' if form_data.get('Loan_Amount_Term') == term }}>{{ term }} months ({{ (term / 12) | int }} yrs)</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="Credit_History">Credit History</label>
                        <select name="Credit_History" id="Credit_History" required>
                            <option value="" disabled {{ '' if form_data.get('Credit_History') is none else '' }} {{ '' if form_data.get('Credit_History') is not none else 'selected' }}>Select</option>
                            <option value="1" {{ 'selected' if form_data.get('Credit_History') == 1.0 }}>Good (1)</option>
                            <option value="0" {{ 'selected' if form_data.get('Credit_History') == 0.0 }}>Bad (0)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Property Details -->
            <div class="form-section last">
                <h2>Property Details</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="Property_Area">Property Area</label>
                        <select name="Property_Area" id="Property_Area" required>
                            <option value="" disabled {{ '' if form_data.get('Property_Area') else 'selected' }}>Select</option>
                            <option value="Urban" {{ 'selected' if form_data.get('Property_Area') == 'Urban' }}>Urban</option>
                            <option value="Semiurban" {{ 'selected' if form_data.get('Property_Area') == 'Semiurban' }}>Semiurban</option>
                            <option value="Rural" {{ 'selected' if form_data.get('Property_Area') == 'Rural' }}>Rural</option>
                        </select>
                    </div>
                </div>
            </div>

            <button type="submit">Check Eligibility</button>
        </form>

        <footer>
            <p>Powered by KNN Model &bull; 87% Accuracy</p>
        </footer>
    </div>
</body>
</html>
